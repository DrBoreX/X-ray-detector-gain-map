Misc code for testing, probably will malfunction in some unexpected way so don't trust the output unless you understand what is going on
